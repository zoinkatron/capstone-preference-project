<!DOCTYPE html>
<html>
  <!--[Header]-->
  <head>
    <base target="_top">
    <title>Localstorage - Preference System</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0/jquery.min.js" type="text/javascript"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>

    <script src="https://cdnaf.b-cdn.net/af.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      
    <style>
      //this is for putting the preference number next to the slider
        .horizontal-items {
            display: flex;
            gap: 10px;
        }

        .preference-slider {
            justify-content: center;
            vertical-align: middle;
            
        }
        .preference-value {
            justify-content: right;
            vertical-align: middle;
            padding: 5%;
        }

        table {

          width: 100%;
          justify-content: left;
          margin: 5px 10px 5px 10px;
        }

         .pref-button {
          margin: 5px 10px 5px 10px;
         }

    </style>

  </head>

  <!--[JavaScript code]-->
  <script>
    $(document).ready(function($)
    {
      //Hide all
	    $('.Screen').hide();

      //Localstorage name
      var LocalstorageName = 'PreferenceSystem';

      function UpdateLocalStorage(Preferences){
        ls.Delete(LocalstorageName);

        $.each(Preferences, function(i,v){
          ls.AddArr(LocalstorageName,v);
        });    
      };
    });

    // Add a new preference submission
    //////////////////////////////////////////////////////////
    // Reminder to remove this code -> not needed anymore   //
    //////////////////////////////////////////////////////////
    $(document).on('click', '.BTN_Add_New', function(event) 
    {
      //Get data from template
      var GetTemplateData = $('.Template_New_Submission').html();

      var now = new Date();
      var inputElementTime = document.getElementsByName("time");
      var inputElementDate = document.getElementsByName("date");
      inputElementTime.value = ("0" + now.getHours()).slice(-2) + ":" + ("0" + now.getMinutes()).slice(-2);
      inputElementDate.value = now.getUTCFullYear() + "-" + ("0" + now.getMonth()).slice(-2) + "-" + ("0" + now.getDate()).slice(-2);

      $('.Screen_Data').html(GetTemplateData);
      $('.Screen_Data').find('.btn_Submission').html('Save').addClass('BTN_Save_New_Submission')
      $('.Screen_Data').show();
    });
    ///////////////////////////////////////////////////////////////
  </script>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script>
    $(document).ready(function(){
      var maxPreferences = 7;
      var i = 0;

      $("#addRow").click(function(){
        //this restricts more preference rows from being added
        if(i <= maxPreferences){
          // iterate on i
          i++;
          // add the new row as html
          $("#myTable").append('<tr id="row'+i+'"><td><input type="text" name="project'+i+'" id="project'+i+'"/></td><td class="horizontal-items"><input type="range" class="preference-slider" name="preference'+i+'" id="preference'+i+'" value="0" min="0" max="7" oninput="this.nextElementSibling.value = this.value" ><output class="preference-value">0</output></td><td><button type="button" name="remove" id="'+i+'" class="btn btn-danger btn_remove">X</button></td></tr>');
          console.log("new row" + i);
        }
        else {
        
        }    
              if (i <= maxPreferences){
          $("#addRow").prop('disabled', false);
      }else {
          $("#addRow").prop('disabled', true);
        }   
        });

  
      $(document).on('click', '.btn_remove', function(){
        var button_id = $(this).attr("id");
        $('#row'+button_id+'').remove();
        i--;
              if (i <= maxPreferences){
          $("#addRow").prop('disabled', false);
      }else {
          $("#addRow").prop('disabled', true);
        }
      });
  
      $("#submit").click(function(){
        // check for duplicate model numbers
        var modelNumbers = $('input[name^="model"]').map(function(){
          return this.value;
        }).get();
        var duplicateModels = modelNumbers.filter(function(item, index){
          return modelNumbers.indexOf(item) != index;
        });
        if(duplicateModels.length > 0){
          alert("Duplicate model numbers found: " + duplicateModels.join(", "));
          $('input[name^="model"]').each(function(){
            if(duplicateModels.indexOf(this.value) != -1){
              $(this).closest('tr').css("background-color", "red");
            }
          });
        }else{
        
        }
      });
    });
  </script>

  <!--[Body]-->  
  <body>
    <h1 class="text-center">Preference Form</h1>

    <!--[Menu - Start]-->
    <div class="text-center">
      <div class="panel panel-primary  center-block">
                <div class="panel-heading text-center" style="padding: 20px;">
                  <span > </span>
        </div>
      </div>
    </div>

    <div class="panel panel-primary  center-block" style="width:60%;">
      <div class="panel-heading text-center">Intructions</div>
        <h4>
          It is your responsibility to read, understand and follow the instructions below:
        </h4>
        <p1>
          By default, Teams have no special preferences for specific Projects
          If your Team does not submit special preferences, we assume your Team has no special preferences.
        </p1>
        <br></br>
      <p1>
        Special preferences range from mild (1) to strong (7).
        Think of them like university grades.
        The higher the number, the stronger the preference.
      </p1>
        <br></br>
      <p1>
        Teams can submit the same levels of preference for multiple Projects.
        We are not asking for you to rank Projects.
        Teams can give two or more Projects the same preference values.
      </p1>
        <br>
      <p1>
        Teams can submit special preferences for up to 10 Projects
        We ignore submissions with preferences for more than 10 Projects.
      </p1>
        <br></br>
      <p1>
        We consider only the most recent submission made by each Team
        Teams can make multiple submissions: we consider only the latest
      </p1>
        <br></br>
      <p1>
        We consider only submissions from students in registered Teams
        We consider only submissions from students in the Team named below.      
      </p1>
      </div>
    </div>
 
    
    <!--[Menu - End]-->
    <br><br>

     <div class="panel panel-primary  center-block" style="width:60%;">
        
          <div class="panel-heading text-center">Add A New Preference</div>
              <table id="myTable" >
              <tr>
                <th >Project ID</th>
                <th >Preference Value</th>
              </tr>
            </table>
            <button class="btn btn-success pref-button" id="addRow">Add New Row</button>
            
            <div class="panel-footing text-center"><button class="btn btn-success pref-button" id="submit">Submit</button></div>
     </div>
  </body>
</html>
